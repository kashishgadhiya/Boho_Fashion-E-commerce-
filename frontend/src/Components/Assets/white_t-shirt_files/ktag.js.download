/* ktag.js - 2024-06-16 */
var Ktag_Constants=function(){return{KENSHOO_GCLID_NAME:"ken_gclid",GOOGLE_CLICK_ID_PARAM_NAME:"gclid",BING_CLICK_ID_PARAM_NAME:"msclkid",NO_PUBLISHER_CLICK_ID_PARAM_NAME:"npclid",AMP_CHANNEL_CLICK_ID_COOKIE_NAME:"ken_amp_gclid",AMP_LINKER_PARAM_NAME:"linker",UNIVERSAL_CHANNEL_PARAM_NAME:"kclid",UNIVERSAL_CHANNEL_COOKIE_NAME:"ken_uc",GBRAID_NAME:"gbraid",WBRAID_NAME:"wbraid",KENSHOO_GBRAID_NAME:"ken_gbraid",KENSHOO_WBRAID_NAME:"ken_wbraid"}}(),Ktag_Toggles=function(){return{isParseAmpLinkerParameters:function(){return!1},isUseNpclid:function(){return!0},isSupportFloodlightTag:function(){return!1},getFixelId:function(){return""},isDummyEnabled:function(){return!0},isDummyDisabled:function(){return!1},isDummyEnabledForDummyTids:function(){return!1},isDummyDisabledForDummyTids:function(){return!0},getDummyString:function(){return"Hello"},getDummyNumber:function(){return 5},isSupportGWbraid:function(){return!0}}}(),Ktag_Amp_Helpers=function(){var i="*",r=/^[a-zA-Z0-9\-_.]+$/,t={"-":"+",_:"/",".":"="},e=function(n){var t=n.split(i),e=t.length%2==0;return t.length<4||!e?null:(t.shift(),t.shift(),t?a(t):null)},a=function(n){for(var t={},e=0;e<n.length;e+=2){var i=n[e];if(r.test(i)&&(t[i]=o(n[e+1]),!t[i]))return null}return t},o=function(n){return l(n)?null:atob(n.replace(/[-_.]/g,function(n){return t[n]}))},l=function(n){return!n||" "===n};return{parseLinker:function(n){return e(n)}}}(),Ktag_Helpers=function(){var t=Ktag_Amp_Helpers,r=Ktag_Constants,l=function(){for(var n=[],t=0;t<256;t++)n[t]=(t<16?"0":"")+t.toString(16);var e=o(),i=o(),r=o(),a=o();return n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+n[255&i]+n[i>>8&255]+"-"+n[i>>16&15|64]+n[i>>24&255]+"-"+n[63&r|128]+n[r>>8&255]+"-"+n[r>>16&255]+n[r>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]},o=function(){return 4294967296*Math.random()>>>0};return{loadPixel:function(n,t){var e=document.location.protocol;0!==e.indexOf("http")&&(e="https:");var i=new Image(1,1);return i.onload=t,i.src=e+"//"+n,i},getParameter:function(n,t){var e=t.indexOf("?");if(-1==e)return null;for(var i=t.substring(e+1).split("&"),r=0;r<i.length;r++){var a=i[r].split("=");if(a[0]===n)return a[1]}return null},generateUUID:function(){return l()},getDomainCookie:function(n){n||(n="k_user_id");for(var t=n+"=",e=document.cookie.split(";"),i=0;i<e.length;i++){for(var r=e[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},createDomainCookie:function(n,t,e,i){if(n){t||(t=l()),e||(e=31536e6);var r=new Date;r.setTime(r.getTime()+e);var a="; expires="+r.toGMTString(),o="";return i&&(o="; domain="+i),document.cookie=n+"="+t+a+o+"; path=/",t}},createRandomDomainCookie:function(n,t){return this.createDomainCookie(n,"",t)},isEmptyString:function(n){return null==n||(Ktag_Helpers.isString(n)?""===Ktag_Helpers.trim(n):!Ktag_Helpers.isNumber(n))},isNumber:function(n){return"number"==typeof n},isString:function(n){return"string"==typeof n},trim:function(n){return n.replace(/^\s+|\s+$/g,"")},getDomain:function(){return window.location.host},makeCORSRequestGET:function(n,t){this.makeCORSRequest(n,t,"GET")},makeCORSRequest:function(n,t,e,i){var r=new XMLHttpRequest;"withCredentials"in r?(r.open(e,n,!0),r.withCredentials=!0):"undefined"!=typeof XDomainRequest?(r=new XDomainRequest).open(e,n):r=null,r&&(r.onload=function(){200==r.status?t(r.responseText):404==r.status&&t(null)},r.onerror=function(){t(null)},r.send(i))},isValidUUID:function(n){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)},isValidKenshooId:function(n){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(n)},isValidGclid:function(n){return/^[A-Za-z0-9_-]{20,120}$/.test(n)},isValidMsclkid:function(n){return/^[A-Fa-f0-9]{32}$/.test(n)},isValidGbraid:function(n){return/^0AAAA.{29}$/.test(n)},isValidWbraid:function(n){return/^C[A-Za-z0-9_-].{60,130}$/.test(n)},getSecondLevelDomain:function(n){if(!n)return null;var t=["ac","ad","ae","aero","af","ag","ai","al","am","an","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","st","su","sv","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","travel","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","xn--0zwm56d","xn--11b5bs3a9aj6g","xn--3e0b707e","xn--45brj9c","xn--80akhbyknj4f","xn--90a3ac","xn--9t4b11yi5a","xn--clchc0ea0b2g2a9gcd","xn--deba0ad","xn--fiqs8s","xn--fiqz9s","xn--fpcrj9c3d","xn--fzc2c9e2c","xn--g6w251d","xn--gecrj9c","xn--h2brj9c","xn--hgbk6aj7f53bba","xn--hlcj6aya9esc7a","xn--j6w193g","xn--jxalpdlp","xn--kgbechtv","xn--kprw13d","xn--kpry57d","xn--lgbbat1ad8j","xn--mgbaam7a8h","xn--mgbayh7gpa","xn--mgbbh1a71e","xn--mgbc0a9azcg","xn--mgberp4a5d4ar","xn--o3cw4h","xn--ogbpf8fl","xn--p1ai","xn--pgbs0dh","xn--s9brj9c","xn--wgbh1c","xn--wgbl6a","xn--xkc2al3hye2a","xn--xkc2dl3a5ee0h","xn--yfro4i67o","xn--ygbi2ammx","xn--zckzah","xxx","ye","yt","za","zm","zw"].join(),e=n.split(".");"www"===e[0]&&"com"!==e[1]&&e.shift();for(var i,r=e.length,a=r,o=e[e.length-1].length;null!==(i=e[--a]);)if(0===a||a<r-2||i.length<o||t.indexOf(i)<0&&a<r-1)return e.slice(a,e.length).join(".");return n},createSecondLevelDomainCookie:function(n,t,e){if(n&&t){var i=this.getSecondLevelDomain(e);this.createDomainCookie(n,t,null,i)}},getChannelClickIdFromUri:function(){var n=this.getValidGclidFromUrl();return n||(n=this.getValidMsclkidFromUrl(),Ktag_Toggles.isUseNpclid()&&!n&&(n=this.getValidNpclidFromUrl())),n},storeChannelClickId:function(){var n=this.getChannelClickIdFromUri();if(n)this.createSecondLevelDomainCookie(r.KENSHOO_GCLID_NAME,n,document.domain);else{if(Ktag_Toggles.isParseAmpLinkerParameters()){var t=this.getAmpLinkerParamsFromUrl();this.createCookiesFromLinkerParameters(t)}Ktag_Helpers.storeUniversalChannelClickId()}if(Ktag_Toggles.isSupportGWbraid()){var e=this.getValidGbraidFromUrl();e&&this.createSecondLevelDomainCookie(r.KENSHOO_GBRAID_NAME,e,document.domain);var i=this.getValidWbraidFromUrl();i&&this.createSecondLevelDomainCookie(r.KENSHOO_WBRAID_NAME,i,document.domain)}},readChannelClickIdFromUrl:function(n,t){t||(t=window.location.href);var e=this.getParameter(n,t);return!e&&Ktag_Toggles.isSupportFloodlightTag()&&(e=this.getFloodlightParameter(n,t)),e?e.split("#")[0]:null},getAmpLinkerParamsFromUrl:function(){var n=this.readChannelClickIdFromUrl(Ktag_Constants.AMP_LINKER_PARAM_NAME);if(n)return t.parseLinker(n)},getValidGclidFromUrl:function(){var n=this.readChannelClickIdFromUrl(Ktag_Constants.GOOGLE_CLICK_ID_PARAM_NAME);if(this.isValidGclid(n))return n},getValidMsclkidFromUrl:function(){var n=this.readChannelClickIdFromUrl(Ktag_Constants.BING_CLICK_ID_PARAM_NAME);if(this.isValidMsclkid(n))return n},getValidNpclidFromUrl:function(){var n=this.readChannelClickIdFromUrl(r.NO_PUBLISHER_CLICK_ID_PARAM_NAME);if(this.isValidGclid(n)||this.isValidMsclkid(n))return n},getValidGbraidFromUrl:function(){var n=this.readChannelClickIdFromUrl(Ktag_Constants.GBRAID_NAME);return this.isValidGbraid(n)?n:null},getValidWbraidFromUrl:function(){var n=this.readChannelClickIdFromUrl(Ktag_Constants.WBRAID_NAME);return this.isValidWbraid(n)?n:null},getFloodlightParameter:function(n,t){for(var e=decodeURIComponent(t).split(/[;&?]/),i=1;i<e.length;i++){var r=e[i].split("=");if(r[0]===n)return r[1]}return null},getUniversalChannelClickId:function(n){n||(n=window.location.href);var t=this.getParameter(Ktag_Constants.UNIVERSAL_CHANNEL_PARAM_NAME,n);return t?t.split("#")[0]:null},storeUniversalChannelClickId:function(){var n=this.getUniversalChannelClickId();n&&this.isValidKenshooId(n)&&this.createSecondLevelDomainCookie(Ktag_Constants.UNIVERSAL_CHANNEL_COOKIE_NAME,n,document.domain)},createCookiesFromLinkerParameters:function(n){if(n){var t=n.channelClickId;(this.isValidGclid(t)||this.isValidMsclkid(t))&&(this.createSecondLevelDomainCookie(Ktag_Constants.KENSHOO_GCLID_NAME,t,document.domain),this.createSecondLevelDomainCookie(Ktag_Constants.AMP_CHANNEL_CLICK_ID_COOKIE_NAME,t,document.domain))}},getCurrentDomain:function(){return document.domain},isFixelIntegrated:function(){return!!Ktag_Toggles.getFixelId()}}}(),Ktag_Functions=function(){var i="https://resources.xg4ken.com/fixel/fixel.min.js",n=function(){var n="script",t=document.createElement(n);t.src=i;var e=Ktag_Toggles.getFixelId();t.onload=function(){runFixel(e)},document.getElementsByTagName(n)[0].parentNode.appendChild(t)};return{runFixelSetup:function(){n()}}}(),setup=function(){Ktag_Helpers.storeChannelClickId(),Ktag_Helpers.isFixelIntegrated()&&Ktag_Functions.runFixelSetup()};try{!function(n){var t=window.ktag;function e(){if(t.ktq)for(;t.ktq.length;){i(t.ktq.shift())}}function i(n){switch(n[0]){case"setup":setup();break;case"event":console.log("event "+n[1])}}t?(t.sendEvent=i,e()):console.log("ktag undefined")}()}catch(n){console.log("Caught unexpected error: "+n)}
//# sourceMappingURL=ktag.js.map